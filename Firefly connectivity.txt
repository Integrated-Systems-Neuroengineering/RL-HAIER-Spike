SERVER 0 FIREFLY CONNECTIVITY (SIMPLEX)


// FPGA 0(port 7) is connected to FPGA 4(port 7)  
FIREFLY7_TX0_N <= FIREFLY7_RX0_N
FIREFLY7_TX0_P <= FIREFLY7_RX0_P 
FIREFLY7_TX1_N <= FIREFLY7_RX1_N 
FIREFLY7_TX1_P <= FIREFLY7_RX1_P 
FIREFLY7_TX2_N <= FIREFLY7_RX2_N
FIREFLY7_TX2_P <= FIREFLY7_RX2_P
FIREFLY7_TX3_N <= FIREFLY7_RX3_N
FIREFLY7_TX3_P <= FIREFLY7_RX3_P
FIREFLY7_TX4_N <= FIREFLY7_RX4_N
FIREFLY7_TX4_P <= FIREFLY7_RX4_P

// FPGA 1(port 7) is connected to FPGA 5(port 7)  
FIREFLY7_TX0_N <= FIREFLY7_RX0_N
FIREFLY7_TX0_P <= FIREFLY7_RX0_P 
FIREFLY7_TX1_N <= FIREFLY7_RX1_N 
FIREFLY7_TX1_P <= FIREFLY7_RX1_P 
FIREFLY7_TX2_N <= FIREFLY7_RX2_N
FIREFLY7_TX2_P <= FIREFLY7_RX2_P
FIREFLY7_TX3_N <= FIREFLY7_RX3_N
FIREFLY7_TX3_P <= FIREFLY7_RX3_P
FIREFLY7_TX4_N <= FIREFLY7_RX4_N
FIREFLY7_TX4_P <= FIREFLY7_RX4_P


// FPGA 2(port 7) is connected to FPGA 6(port 7)  
FIREFLY7_TX0_N <= FIREFLY7_RX0_N
FIREFLY7_TX0_P <= FIREFLY7_RX0_P 
FIREFLY7_TX1_N <= FIREFLY7_RX1_N 
FIREFLY7_TX1_P <= FIREFLY7_RX1_P 
FIREFLY7_TX2_N <= FIREFLY7_RX2_N
FIREFLY7_TX2_P <= FIREFLY7_RX2_P
FIREFLY7_TX3_N <= FIREFLY7_RX3_N
FIREFLY7_TX3_P <= FIREFLY7_RX3_P
FIREFLY7_TX4_N <= FIREFLY7_RX4_N
FIREFLY7_TX4_P <= FIREFLY7_RX4_P


// FPGA 3(port 7) is connected to FPGA 7(port 7)  
FIREFLY7_TX0_N <= FIREFLY7_RX0_N
FIREFLY7_TX0_P <= FIREFLY7_RX0_P 
FIREFLY7_TX1_N <= FIREFLY7_RX1_N 
FIREFLY7_TX1_P <= FIREFLY7_RX1_P 
FIREFLY7_TX2_N <= FIREFLY7_RX2_N
FIREFLY7_TX2_P <= FIREFLY7_RX2_P
FIREFLY7_TX3_N <= FIREFLY7_RX3_N
FIREFLY7_TX3_P <= FIREFLY7_RX3_P
FIREFLY7_TX4_N <= FIREFLY7_RX4_N
FIREFLY7_TX4_P <= FIREFLY7_RX4_P


// FPGA 4(port 6) is connected to FPGA 7(port 6)  
FIREFLY6_TX0_N <= FIREFLY6_RX0_N
FIREFLY6_TX0_P <= FIREFLY6_RX0_P 
FIREFLY6_TX1_N <= FIREFLY6_RX1_N 
FIREFLY6_TX1_P <= FIREFLY6_RX1_P 
FIREFLY6_TX2_N <= FIREFLY6_RX2_N
FIREFLY6_TX2_P <= FIREFLY6_RX2_P
FIREFLY6_TX3_N <= FIREFLY6_RX3_N
FIREFLY6_TX3_P <= FIREFLY6_RX3_P
FIREFLY6_TX4_N <= FIREFLY6_RX4_N
FIREFLY6_TX4_P <= FIREFLY6_RX4_P


// FPGA 4(port 5) is connected to FPGA 6(port 6)
FIREFLY5_TX0_N <= FIREFLY6_RX0_N
FIREFLY5_TX0_P <= FIREFLY6_RX0_P 
FIREFLY5_TX1_N <= FIREFLY6_RX1_N 
FIREFLY5_TX1_P <= FIREFLY6_RX1_P 
FIREFLY5_TX2_N <= FIREFLY6_RX2_N
FIREFLY5_TX2_P <= FIREFLY6_RX2_P
FIREFLY5_TX3_N <= FIREFLY6_RX3_N
FIREFLY5_TX3_P <= FIREFLY6_RX3_P
FIREFLY5_TX4_N <= FIREFLY6_RX4_N
FIREFLY5_TX4_P <= FIREFLY6_RX4_P


// FPGA 5(port 6) is connected to FPGA 7(port 5)
FIREFLY6_TX0_N <= FIREFLY5_RX0_N
FIREFLY6_TX0_P <= FIREFLY5_RX0_P 
FIREFLY6_TX1_N <= FIREFLY5_RX1_N 
FIREFLY6_TX1_P <= FIREFLY5_RX1_P 
FIREFLY6_TX2_N <= FIREFLY5_RX2_N
FIREFLY6_TX2_P <= FIREFLY5_RX2_P
FIREFLY6_TX3_N <= FIREFLY5_RX3_N
FIREFLY6_TX3_P <= FIREFLY5_RX3_P
FIREFLY6_TX4_N <= FIREFLY5_RX4_N
FIREFLY6_TX4_P <= FIREFLY5_RX4_P


// FPGA 5(port 5) is connected to FPGA 6(port 5)
FIREFLY5_TX0_N <= FIREFLY5_RX0_N
FIREFLY5_TX0_P <= FIREFLY5_RX0_P 
FIREFLY5_TX1_N <= FIREFLY5_RX1_N 
FIREFLY5_TX1_P <= FIREFLY5_RX1_P 
FIREFLY5_TX2_N <= FIREFLY5_RX2_N
FIREFLY5_TX2_P <= FIREFLY5_RX2_P
FIREFLY5_TX3_N <= FIREFLY5_RX3_N
FIREFLY5_TX3_P <= FIREFLY5_RX3_P
FIREFLY5_TX4_N <= FIREFLY5_RX4_N
FIREFLY5_TX4_P <= FIREFLY5_RX4_P


// FPGA 4(port 4) is connected to FPGA 5(port 4)
FIREFLY4_TX0_N <= FIREFLY4_RX0_N
FIREFLY4_TX0_P <= FIREFLY4_RX0_P 
FIREFLY4_TX1_N <= FIREFLY4_RX1_N 
FIREFLY4_TX1_P <= FIREFLY4_RX1_P 
FIREFLY4_TX2_N <= FIREFLY4_RX2_N
FIREFLY4_TX2_P <= FIREFLY4_RX2_P
FIREFLY4_TX3_N <= FIREFLY4_RX3_N
FIREFLY4_TX3_P <= FIREFLY4_RX3_P
FIREFLY4_TX4_N <= FIREFLY4_RX4_N
FIREFLY4_TX4_P <= FIREFLY4_RX4_P


// FPGA 6(port 4) is connected to FPGA 7(port 4)
FIREFLY4_TX0_N <= FIREFLY4_RX0_N
FIREFLY4_TX0_P <= FIREFLY4_RX0_P 
FIREFLY4_TX1_N <= FIREFLY4_RX1_N 
FIREFLY4_TX1_P <= FIREFLY4_RX1_P 
FIREFLY4_TX2_N <= FIREFLY4_RX2_N
FIREFLY4_TX2_P <= FIREFLY4_RX2_P
FIREFLY4_TX3_N <= FIREFLY4_RX3_N
FIREFLY4_TX3_P <= FIREFLY4_RX3_P
FIREFLY4_TX4_N <= FIREFLY4_RX4_N
FIREFLY4_TX4_P <= FIREFLY4_RX4_P





CRIO FIREFLY CONNECTIVITY
SERVER ZERO

There are 4 differential pairs in and four out for each port (ports 4,5,6,7 on the AD board). 
Each differential pair is one twinax 
FIREFLY4_TX([0,1,2,3])_N  = 4 pairs that transmit out of port 4
FIREFLY4_TX([0,1,2,3])_P  = 4 pairs that transmit out of port 4



// FPGA (port 4) is connected to FPGA (port 6)
FIREFLY4_TX0_N <= FIREFLY6_RX0_N
FIREFLY4_TX0_P <= FIREFLY6_RX0_P 
FIREFLY4_TX1_N <= FIREFLY6_RX1_N 
FIREFLY4_TX1_P <= FIREFLY6_RX1_P 
FIREFLY4_TX2_N <= FIREFLY6_RX2_N
FIREFLY4_TX2_P <= FIREFLY6_RX2_P
FIREFLY4_TX3_N <= FIREFLY6_RX3_N
FIREFLY4_TX3_P <= FIREFLY6_RX3_P


// FPGA (port 5) is connected to FPGA (port 7)
FIREFLY5_TX0_N <= FIREFLY7_RX0_N
FIREFLY5_TX0_P <= FIREFLY7_RX0_P 
FIREFLY5_TX1_N <= FIREFLY7_RX1_N 
FIREFLY5_TX1_P <= FIREFLY7_RX1_P 
FIREFLY5_TX2_N <= FIREFLY7_RX2_N
FIREFLY5_TX2_P <= FIREFLY7_RX2_P
FIREFLY5_TX3_N <= FIREFLY7_RX3_N
FIREFLY5_TX3_P <= FIREFLY7_RX3_P


Let each port of the FPGAs be both an input and output.

This system has 8 FPGAs connected in a certain way physically through Firefly cables. There are 4 differential pairs in and four out for each port. Each FPGA has four Firefly ports (Ports 4, Port 5, Port 6, and Port 7) through which each connections with the other FPGAs are made. FPGA 0 (port 7) is connected to FPGA 4(port 7), FPGA 1(port 7) is connected to FPGA 5(port 7), FPGA 2(port 7) is connected to FPGA 6(port 7), FPGA 3(port 7) is connected to FPGA 7(port 7), FPGA 4(port 6) is connected to FPGA 7(port 6), FPGA 4(port 5) is connected to FPGA 6(port 6), FPGA 5(port 6) is connected to FPGA 7(port 5), FPGA 5(port 5) is connected to FPGA 6(port 5), FPGA 4(port 4) is connected to FPGA 5(port 4), FPGA 6(port 4) is connected to FPGA 7(port 4). Aurora protocol 64/65b IP in Xilinx Vivado is the serial communications protocol used for multi-gigabit links to connect all the FPGAs. A random number generator module is used to generate a random number sequence of packets that will be used as input sequence to confirm that the packet sent is received at the output.  Write the verilog code of the whole system. Comment each line of the code.




